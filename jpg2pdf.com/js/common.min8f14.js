const app=new App(appSettings);(function(){function t(t){if(!app)return;t.preventDefault();let e,n=t.dataTransfer,i=t.target;if(e=n?n.files:i.files,e){e=Array.prototype.slice.call(e);for(let t in e){let n=e[t];app.add(n)}n||(t.target.value="")}}const e=document.querySelector("#fileSelector"),n=document.querySelector("[for='fileSelector']");e&&e.addEventListener("change",t),n&&n.addEventListener("keypress",function(t){32!=t.keyCode&&13!=t.keyCode||(t.preventDefault(),e.click())}),window.addEventListener("drop",t,!0),window.addEventListener("dragover",function(t){const e=Array.prototype.slice.call(t.dataTransfer.types);t.preventDefault();for(let n in e){let i=e[n];if(-1!=i.indexOf("text"))return void(t.dataTransfer.dropEffect="none")}t.dataTransfer.dropEffect=app.list.length<appSettings.maxLength?"copy":"none"},!0)})(),function(){const t=function(t,e,n){function i(){a.open(t,e,!0),t==l?a.send():a.send(o(d))}function o(){const t=new FormData;for(let e in d)t.append(e,d[e]);return t}function s(t,e){return c[t]||(c[t]=[]),c[t].push(e),this}function r(t){if(c[t])for(let e in c[t]){let n=c[t][e];n.apply(this,Array.prototype.slice.call(arguments,1))}}n=n||{};const l="GET",a=new XMLHttpRequest,c={},d=n&&Object.assign({},n.data);if(t=t.toUpperCase(),this.timeoutId=-1,this.stopped=!1,this.abort=function(){this.stopped=!0,clearTimeout(this.timeoutId),a.abort()},this.onLoad=s.bind(this,"load"),this.onFinal=s.bind(this,"final"),this.onProgress=s.bind(this,"progress"),this.onAbort=s.bind(this,"abort"),this.onError=s.bind(this,"error"),d.rnd=Math.random(),t==l){e+="?";for(let t in d)e+="&"+t+"="+encodeURIComponent(d[t]);e=e.replace("?&","?")}a.addEventListener("load",function(){let t=a.response;if(200!=a.status)return r("error",a.status+": "+a.statusText),void r("final");if(n.type||(t=JSON.parse(t)),"error"==t.status)return clearTimeout(this.timeoutId),r("error",t.details),void r("final");if(n.progress){if(100==t[n.progress.key])return clearTimeout(this.timeoutId),r("load",t),void r("final");if(e==n.progress.url){if(this.stopped)return;return r("progress",t[n.progress.key]),void(this.timeoutId=setTimeout(i,500))}return e=n.progress.url,void i()}r("load",t),r("final")}.bind(this)),a.addEventListener("error",function(t){r("error",t),r("final")}),a.addEventListener("abort",function(t){r(c.abort?"abort":"error",t.type),r("final")}),a.upload&&a.upload.addEventListener("progress",function(t){r("progress",t.loaded/t.total)}),i()};window.Ajax=t}(),function(){function t(){for(let t in o){let e=o[t];e.close()}}function e(t){for(let e in o)if(t==o[e]){o.splice(e,1);break}}function n(t){let e=document.createElement("div");return e.innerHTML=t,e.firstElementChild}let i=document.querySelector("#template-popup");if(!i)return;const o=[],s=n(i.innerHTML),r=document.querySelectorAll("[data-popup]");if(!r||!r.length)return;i.parentNode.removeChild(i),i=void 0,Array.prototype.forEach.call(r,function(t){t.addEventListener("click",function(t){t.preventDefault(),new l(this)})}),document.addEventListener("click",function(e){o.length&&!e.target.closest(".popup__overflow")&&t()});const l=function(n){function i(e){this.content=e,this.elem=s.cloneNode(!0),this.elem.querySelector(".popup__title").innerHTML=this.title,this.elem.querySelector(".popup__content").innerHTML=this.content,this.elem.querySelector(".popup__close").addEventListener("click",function(t){t.preventDefault(),this.close()}.bind(this)),t(),document.body.appendChild(this.elem),setTimeout(function(){this.elem.classList.add("popup_visible"),o.push(this)}.bind(this),100)}function r(){this.elem.classList.contains("popup_visible")?(this.elem.addEventListener("transitionend",function(t){t.target==this.elem&&"opacity"==t.propertyName&&(this.visible=!1,l.call(this))}.bind(this)),this.elem.classList.remove("popup_visible")):l.call(this)}function l(){this.elem&&this.elem.parentNode.removeChild(this.elem);for(let t in this)delete this[t];e(this)}this.elem=null,this.href=n.href,this.title=n.dataset.popup||n.title,this.close=r,new Ajax("GET",this.href,{type:"text"}).onLoad(i.bind(this))}}(),function(){const t=document.querySelector("#language");t&&t.addEventListener("change",function(){location.href=("/"==this.value[0]?"":"/")+this.value})}(),function(){function t(){for(;s.length<o&&r.length;){let t=r.shift();s.push(t),setTimeout(function(){e(t.elem)},i)}for(let t in s){let e=s[t];a.contains(e.elem)||(a.children.length?a.insertBefore(e.elem,a.firstElementChild):a.appendChild(e.elem))}requestAnimationFrame(function(){a.style.transform="translate3d(-50%,"+a.offsetHeight+"px,0)"})}function e(e){for(let n in s){let i=s[n];if(i.elem==e){i.remove(),s.splice(n,1),e.addEventListener("transitionend",function(n){"opacity"==n.propertyName&&n.target==e&&(e.parentNode.removeChild(e),t())}),e.style.height=e.offsetHeight+"px",requestAnimationFrame(function(){e.classList.add("notices__item_hidden")});break}}}function n(){const t=document.createElement("ul");return t.classList.add("notices"),t.addEventListener("click",function(t){const n=t.target.closest(".notices__item");n&&e(n)}),document.body.appendChild(t),t}const i=5e3,o=5,s=[],r=[],l=function(){const t=document.querySelector("#template-notice"),e=document.createElement("div");if(t)return e.innerHTML=t.innerHTML,t.parentNode.removeChild(t),e.firstElementChild}();let a=null;if(!l)return;const c=function(e){a||(a=n()),this.elem=l.cloneNode(!0),this.elem.firstElementChild.insertAdjacentHTML("afterbegin",e),this.remove=function(){for(let t in this)delete this[t]},r.push(this),t()};window.Notice=c}(),function(){const t=document.querySelectorAll("[data-convert-params]");t&&app.convertParams&&Array.prototype.forEach.call(document.querySelectorAll("[data-convert-params]"),function(t){t.addEventListener("change",function(t){app.convertParams[t.target.name]=t.target.value,app.clear()})})}(),function(){let t=document.querySelectorAll("[data-share]");t=Array.prototype.slice.call(t);for(let e in t){let n=t[e],i=n.getAttribute("href");i=i.replace("{{url}}",encodeURIComponent(appSettings.origin||location.href)),i=i.replace("{{text}}",encodeURIComponent(appSettings.title||document.title)),n.setAttribute("href",i)}}(),function(){function t(t){function n(){this.scrollTo=i,this.stop=o,this.tick=s,this.elem=t,this.pos={from:null,to:null,dur:null},this.time={start:null,end:null},this.timerId=null,this.duration=null,e.push(this)}function i(t,e,n){this.stop();let i=this.elem.offsetWidth,o=this.elem.scrollWidth-i;this.pos.from=this.elem.scrollLeft,this.callback=n,t>=o&&o==this.pos.from||t<=0&&!this.pos.from?this.callback&&this.callback():(this.pos.to=Math.max(0,Math.min(o,t)),this.pos.dur=this.pos.to-this.pos.from,this.pos.to!=t&&this.pos.to&&Number.isFinite(t)?this.duration=e*(this.pos.to/t):this.duration=e,this.time.start=performance.now(),this.time.end=this.time.start+this.duration,this.tick())}function o(){cancelAnimationFrame(this.timerId),n.call(this)}function s(){let t=performance.now();this.time.dur=t-this.time.start,value=r(this.time.dur,this.pos.from,this.pos.dur,this.duration),this.elem.scrollLeft=value,t<this.time.end&&value!=this.pos.to?this.timerId=requestAnimationFrame(s.bind(this)):(this.elem.scrollLeft=this.pos.to,this.callback&&this.callback(),this.stop())}function r(t,e,n,i){return t/=i/2,t<1?n/2*t*t+e:(t--,-n/2*(t*(t-2)-1)+e)}for(let n in e){let i=e[n];if(i.elem==t)return i}n.call(this)}const e=[];window.SmoothScroll=t}(),function(){if(!appSettings||!app||!appSettings.sortable)return;const t={scroller:"files__list",item:"files__file",spacer:"files__list-spacer",active:"file_drag-active",move:"file_drag-move",sortable:"files__list_sortable",overflowHidden:"files__list_owf-hidden"},e=["button",".file__title"],n=5,i=function(i,o,s){function r(){if(_=document.querySelector(i),!_)return null;this.scroller=_,x=_.firstElementChild,y()&&this.scroller.classList.add(t.overflowHidden),this.scroller.classList.add(t.sortable),s&&(s=s.bind(this)),Object.defineProperty(b,"activeElement",{get:function(){return S},set:function(e){S&&S.classList.remove(t.active),S&&S.classList.remove(t.move),S=e,S&&S.classList.add(t.active),S&&S.classList.add(t.move)}}),l(),a.call(this)}function l(){b.activeElement=null,b.startX=0,b.mosueX=0,b.min=0,b.max=0,b.requestId=-1,b.disabled=!1,b.padding=0,b.scrollLeftEdge=null,b.scrollRightEdge=null,b.scrollBy=0}function a(){_.addEventListener("mousedown",c.bind(this)),_.addEventListener("touchstart",c.bind(this),{passive:!0})}function c(t){if(b.disabled)return;let n=e.length&&t.target.closest(e.join(",")),i=t.target.closest(o);if(n||!i)return void l();let s=!!t.touches;b.activeElement=i,b.padding=x.offsetLeft;let r=_.getBoundingClientRect();b.scrollLeftEdge=r.left+b.padding,b.scrollRightEdge=r.left+r.width-b.padding,u(t),b.startX=b.mouseX,b.startScrollLeft=_.scrollLeft,b.shiftByScroll=0,b.min=-b.activeElement.offsetLeft,b.max=x.offsetWidth-b.activeElement.offsetLeft-b.activeElement.offsetWidth,b.centerX=b.activeElement.offsetLeft+b.activeElement.offsetWidth/2,h.call(this),w=g.call(this),window.addEventListener(s?"touchmove":"mousemove",u),window.addEventListener(s?"touchend":"mouseup",d),b.activeElement.addEventListener("click",m,!0),_.addEventListener("scroll",f),b.requestId=requestAnimationFrame(v.bind(this))}function d(){function e(n){if(!n||"transform"==n.propertyName){b.activeElement.removeEventListener("transitionend",e);for(let e in w){let n=w[e];n.node.classList.add(t.move),E(n.node,0),x.appendChild(n.node)}requestAnimationFrame(function(){b.disabled=!1;for(let e in w){let n=w[e];n.node.classList.remove(t.move)}b.activeElement=null,p.call(this),s&&s(w.map(function(t){return t.startIndex}))})}}cancelAnimationFrame(b.requestId),window.removeEventListener("mousemove",u),window.removeEventListener("mouseup",d),b.activeElement.removeEventListener("click",m,!0),b.disabled=!0,b.scrollBy=0,b.activeElement.addEventListener("transitionend",e),b.activeElement.classList.remove(t.move),requestAnimationFrame(function(){let t=0;for(t in w){let e=w[t];if(e.node==b.activeElement)break}let n,i=w[t].from-b.activeElement.offsetLeft,o=window.getComputedStyle(b.activeElement);n="undefined"!=typeof WebKitCSSMatrix?new WebKitCSSMatrix(o.transform).m41:new MSCSSMatrix(o.transform).m41,i!=n?E(b.activeElement,i):e()})}function u(t){b.mouseX=t.touches?t.touches[0].clientX:t.clientX,b.mouseX<=b.scrollLeftEdge?b.scrollBy=-1:b.mouseX>=b.scrollRightEdge?b.scrollBy=1:b.scrollBy=0}function f(){b.shiftByScroll=b.startScrollLeft-_.scrollLeft}function m(t){t.preventDefault(),t.stopPropagation()}function h(){let e=document.createElement("div");e.classList.add(t.spacer),e.style.width=_.scrollWidth+"px",_.appendChild(e)}function p(){let e=_.querySelector("."+t.spacer);e&&e.parentNode.removeChild(e)}function v(){b.scrollBy&&(_.scrollLeft+=b.scrollBy*n);let t=b.mouseX-b.startX-b.shiftByScroll,e=null;t<=b.min&&(t=b.min),t>=b.max&&(t=b.max),e=b.centerX+t,E(b.activeElement,t);for(let t in w){let n=w[t];if(e>=n.from&&e<=n.to&&n.node!=b.activeElement){L.call(this,t);break}}b.requestId=requestAnimationFrame(v.bind(this))}function E(t,e){t&&(e?(t.style.transform="translateX("+e+"px)",t.style.transform="translate3d("+e+"px, 0, 0)"):t.style.removeProperty("transform"))}function L(t){function e(t,e,n){w[t].node=e,w[t].startIndex=n,w[t].node!=b.activeElement&&E(w[t].node,w[t].from-w[t].node.offsetLeft)}let n=null,i=null;for(let e in w){let o=w[e];o.node!=b.activeElement&&e!=t||(null===n?n=+e:i=+e)}let o=w[n].node,s=w[n].startIndex;for(let t=n;t<i;t++)e(t,w[t+1].node,w[t+1].startIndex);e(i,o,s)}function g(){const t=[];return Array.prototype.forEach.call(_.firstElementChild.children,function(e,n){let i=e.offsetLeft;t.push({node:e,from:i,to:i+e.offsetWidth,startIndex:n})}),t}function y(){return"ontouchstart"in window||navigator.maxTouchPoints>0||navigator.msMaxTouchPoints>0}const b={};let w=[],S=null,_=null,x=null;return r.call(this),this};window.SortableList=i,new i("."+t.scroller,"."+t.item,function(t){app.setOrder(t)})}();